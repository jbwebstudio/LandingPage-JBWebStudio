import{DOM,Events}from"./utils.js";const ANIMATION_CONFIG={duration:{fast:300,normal:600,slow:1e3},easing:{easeOut:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",easeIn:"cubic-bezier(0.55, 0.055, 0.675, 0.19)",easeInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)"},threshold:.1,rootMargin:"0px 0px -50px 0px"};class AnimationManager{constructor(){this.observers=new Map;this.animatedElements=new Set;this.isReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches;this.init()}init(){this.setupIntersectionObserver();this.setupScrollAnimations();this.setupHoverAnimations();this.setupLoadingAnimations();this.setupParallaxEffects();this.setupCounterAnimations();this.setupTypingEffect()}setupIntersectionObserver(){if(this.isReducedMotion)return;const observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting&&!this.animatedElements.has(entry.target)){this.animateElement(entry.target);this.animatedElements.add(entry.target)}})},{threshold:ANIMATION_CONFIG.threshold,rootMargin:ANIMATION_CONFIG.rootMargin});const animatableElements=DOM.selectAll([".animate-on-scroll",".service-card",".process-step",".portfolio-item",".testimonial-card-grid",".stat-item",".footer-section",".footer-brand"].join(", "));animatableElements.forEach(el=>observer.observe(el));this.observers.set("scroll",observer)}animateElement(element){const animationType=DOM.getData(element,"animation")||"fadeInUp";const delay=DOM.getData(element,"delay")||0;setTimeout(()=>{DOM.addClass(element,"animate");DOM.addClass(element,`animate-${animationType}`)},delay)}setupScrollAnimations(){let ticking=false;const updateScrollAnimations=()=>{const scrollY=window.pageYOffset;const windowHeight=window.innerHeight;const navbar=DOM.select(".navbar");if(navbar){if(scrollY>100){DOM.addClass(navbar,"scrolled")}else{DOM.removeClass(navbar,"scrolled")}}const backToTop=DOM.select(".back-to-top");if(backToTop){if(scrollY>500){DOM.addClass(backToTop,"show")}else{DOM.removeClass(backToTop,"show")}}this.updateProgressBar();ticking=false};const onScroll=()=>{if(!ticking){requestAnimationFrame(updateScrollAnimations);ticking=true}};Events.on(window,"scroll",Events.throttle(onScroll,16))}updateProgressBar(){const progressBar=DOM.select(".progress-bar");if(!progressBar)return;const scrollTop=window.pageYOffset;const docHeight=document.documentElement.scrollHeight-window.innerHeight;const scrollPercent=scrollTop/docHeight*100;progressBar.style.width=`${Math.min(scrollPercent,100)}%`}setupHoverAnimations(){const cards=DOM.selectAll(".service-card, .portfolio-item, .testimonial-card-grid");cards.forEach(card=>{Events.on(card,"mouseenter",()=>{if(!this.isReducedMotion){DOM.addClass(card,"hovered")}});Events.on(card,"mouseleave",()=>{DOM.removeClass(card,"hovered")})});const buttons=DOM.selectAll(".btn");buttons.forEach(btn=>{Events.on(btn,"mouseenter",()=>{if(!this.isReducedMotion){this.addRippleEffect(btn)}})})}addRippleEffect(button){const ripple=DOM.create("span","ripple");button.appendChild(ripple);const rect=button.getBoundingClientRect();const size=Math.max(rect.width,rect.height);ripple.style.width=ripple.style.height=size+"px";setTimeout(()=>{if(ripple.parentNode){ripple.parentNode.removeChild(ripple)}},600)}setupLoadingAnimations(){const grids=DOM.selectAll(".services-grid, .portfolio-grid, .testimonials-grid");grids.forEach(grid=>{const items=grid.children;Array.from(items).forEach((item,index)=>{DOM.setData(item,"delay",index*100)})});this.setupSkeletonLoading()}setupSkeletonLoading(){const skeletons=DOM.selectAll(".skeleton");skeletons.forEach(skeleton=>{const shimmer=DOM.create("div","skeleton-shimmer");skeleton.appendChild(shimmer);const observer=new MutationObserver(()=>{if(skeleton.children.length>1){DOM.removeClass(skeleton,"skeleton");observer.disconnect()}});observer.observe(skeleton,{childList:true})})}setupParallaxEffects(){if(this.isReducedMotion)return;const parallaxElements=DOM.selectAll("[data-parallax]");if(parallaxElements.length===0)return;const updateParallax=()=>{const scrollY=window.pageYOffset;parallaxElements.forEach(element=>{const speed=parseFloat(DOM.getData(element,"parallax"))||.5;const yPos=-(scrollY*speed);element.style.transform=`translateY(${yPos}px)`})};Events.on(window,"scroll",Events.throttle(updateParallax,16))}setupCounterAnimations(){const counters=DOM.selectAll("[data-counter]");if(counters.length===0)return;const observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){this.animateCounter(entry.target);observer.unobserve(entry.target)}})},{threshold:.5});counters.forEach(counter=>observer.observe(counter))}animateCounter(element){const target=parseInt(DOM.getData(element,"counter"));const duration=parseInt(DOM.getData(element,"duration"))||2e3;const increment=target/(duration/16);let current=0;const updateCounter=()=>{current+=increment;if(current<target){element.textContent=Math.floor(current);requestAnimationFrame(updateCounter)}else{element.textContent=target}};updateCounter()}setupTypingEffect(){const typingElements=DOM.selectAll("[data-typing]");typingElements.forEach(element=>{const text=DOM.getData(element,"typing");const speed=parseInt(DOM.getData(element,"typing-speed"))||100;const delay=parseInt(DOM.getData(element,"typing-delay"))||0;setTimeout(()=>{this.typeText(element,text,speed)},delay)})}typeText(element,text,speed){element.textContent="";let i=0;const typeChar=()=>{if(i<text.length){element.textContent+=text.charAt(i);i++;setTimeout(typeChar,speed)}else{const cursor=DOM.create("span","typing-cursor");cursor.textContent="|";element.appendChild(cursor)}};typeChar()}animatePageEntry(){const hero=DOM.select(".hero");if(hero){DOM.addClass(hero,"animate-fadeInUp")}const navItems=DOM.selectAll(".nav-item");navItems.forEach((item,index)=>{setTimeout(()=>{DOM.addClass(item,"animate-fadeInDown")},index*100)})}animateSectionTransition(fromSection,toSection){return new Promise(resolve=>{DOM.addClass(fromSection,"animate-fadeOut");setTimeout(()=>{fromSection.style.display="none";toSection.style.display="block";DOM.addClass(toSection,"animate-fadeIn");resolve()},ANIMATION_CONFIG.duration.fast)})}createCustomAnimation(element,keyframes,options={}){if(this.isReducedMotion)return;const defaultOptions={duration:ANIMATION_CONFIG.duration.normal,easing:ANIMATION_CONFIG.easing.easeOut,fill:"forwards"};const animationOptions={...defaultOptions,...options};return element.animate(keyframes,animationOptions)}pauseAnimations(){const style=DOM.create("style");style.textContent=`
            *, *::before, *::after {
                animation-play-state: paused !important;
                transition: none !important;
            }
        `;document.head.appendChild(style);DOM.setData(document.body,"animations-paused","true")}resumeAnimations(){const pauseStyle=DOM.select("style[data-pause-animations]");if(pauseStyle){pauseStyle.remove()}DOM.removeAttr(document.body,"data-animations-paused")}cleanup(){this.observers.forEach(observer=>observer.disconnect());this.observers.clear();this.animatedElements.clear()}}export const AnimationUtils={shake:(element,intensity=10)=>{if(!element)return;const keyframes=[{transform:"translateX(0)"},{transform:`translateX(-${intensity}px)`},{transform:`translateX(${intensity}px)`},{transform:"translateX(0)"}];return element.animate(keyframes,{duration:500,easing:"ease-in-out"})},bounce:element=>{if(!element)return;const keyframes=[{transform:"translateY(0)"},{transform:"translateY(-20px)"},{transform:"translateY(0)"},{transform:"translateY(-10px)"},{transform:"translateY(0)"}];return element.animate(keyframes,{duration:800,easing:"ease-out"})},pulse:(element,scale=1.1)=>{if(!element)return;const keyframes=[{transform:"scale(1)"},{transform:`scale(${scale})`},{transform:"scale(1)"}];return element.animate(keyframes,{duration:600,easing:"ease-in-out"})},rotate:(element,degrees=360)=>{if(!element)return;const keyframes=[{transform:"rotate(0deg)"},{transform:`rotate(${degrees}deg)`}];return element.animate(keyframes,{duration:1e3,easing:"ease-in-out"})},slideIn:(element,direction="left",distance=100)=>{if(!element)return;const transforms={left:[`translateX(-${distance}px)`,"translateX(0)"],right:[`translateX(${distance}px)`,"translateX(0)"],up:[`translateY(-${distance}px)`,"translateY(0)"],down:[`translateY(${distance}px)`,"translateY(0)"]};const[from,to]=transforms[direction]||transforms.left;const keyframes=[{transform:from,opacity:0},{transform:to,opacity:1}];return element.animate(keyframes,{duration:600,easing:"ease-out",fill:"forwards"})}};let animationManager=null;document.addEventListener("DOMContentLoaded",function(){const heroLogo=document.querySelector(".hero-logo-image");if(heroLogo){setTimeout(()=>{heroLogo.classList.add("loaded")},2e3)}});export const initAnimations=()=>{if(document.readyState==="loading"){Events.on(document,"DOMContentLoaded",()=>{animationManager=new AnimationManager})}else{animationManager=new AnimationManager}};export const getAnimationManager=()=>animationManager;export default{AnimationManager:AnimationManager,AnimationUtils:AnimationUtils,initAnimations:initAnimations,getAnimationManager:getAnimationManager};